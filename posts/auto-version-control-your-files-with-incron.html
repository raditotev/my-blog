<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><meta name="og:title" content="Auto Version Control Your Files with incron" class="jsx-eb7a88ca53252729"/><title class="jsx-eb7a88ca53252729">Auto Version Control Your Files with incron</title><meta name="next-head-count" content="4"/><link rel="icon" href="/favicon/favicon.ico"/><meta name="description" content="A collection of technical posts."/><script async="" src="https://www.googletagmanager.com/gtag/js?id=undefined"></script><script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'undefined', {
              page_path: window.location.pathname,
            });
          </script><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-9b312e20a4e32339.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-f65e66e62fc5ca80.js" defer=""></script><script src="/_next/static/chunks/pages/_app-02d0f4839caa4a8e.js" defer=""></script><script src="/_next/static/chunks/83-7030382a9597fa38.js" defer=""></script><script src="/_next/static/chunks/32-1cf93db441761c8a.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-7655989d47098e38.js" defer=""></script><script src="/_next/static/2pUE-tzp7EsMDGnqIcye_/_buildManifest.js" defer=""></script><script src="/_next/static/2pUE-tzp7EsMDGnqIcye_/_ssgManifest.js" defer=""></script><script src="/_next/static/2pUE-tzp7EsMDGnqIcye_/_middlewareManifest.js" defer=""></script><style id="__jsx-fdefdd4b6c4ce2c4">span.jsx-fdefdd4b6c4ce2c4{color:#333;font-size:.9rem}</style><style id="__jsx-7814f24efc48ee15">.list-categories.jsx-7814f24efc48ee15 a.jsx-7814f24efc48ee15{color:#333;text-transform:uppercase;font-size:.6rem;font-weight:700;margin-right:10px}</style><style id="__jsx-eb7a88ca53252729">.post.jsx-eb7a88ca53252729{width:100%}header.jsx-eb7a88ca53252729{text-align:center;margin-bottom:3rem}.post.jsx-eb7a88ca53252729 h1.jsx-eb7a88ca53252729{margin-bottom:.2rem}a.jsx-eb7a88ca53252729{color:black}footer.jsx-eb7a88ca53252729{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}footer.jsx-eb7a88ca53252729 a.go-back.jsx-eb7a88ca53252729{font-size:1.5rem}@media(max-width:820px){footer.jsx-eb7a88ca53252729{display:block}footer.jsx-eb7a88ca53252729 a.go-back.jsx-eb7a88ca53252729{float:right}}</style><style id="__jsx-5cae0e9dd922305c">html,body{padding:0;margin:0;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-size:20px}*{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}p{font-weight:400;line-height:32px}a{text-decoration:none}img{width:100%}img[src*="#center"]{display:block;margin:auto}@media(max-width:820px){body{font-size:18px}p{line-height:28px}img{max-width:80vw}}</style><style id="__jsx-53df2e978e8b299a">header.jsx-5a195dee6678eb3{width:100vw;padding:1.7rem;background-color:rgba(0,0,0,.9);text-align:center}header.jsx-5a195dee6678eb3 h1.jsx-5a195dee6678eb3{margin:0}header.jsx-5a195dee6678eb3 a.jsx-5a195dee6678eb3{text-decoration:none;color:crimson}main.jsx-5a195dee6678eb3{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;margin:20px auto;max-width:820px}@media(max-width:820px){main.jsx-5a195dee6678eb3{width:95vw}}</style></head><body><div id="__next" data-reactroot=""><div class="jsx-5a195dee6678eb3"><header class="jsx-5a195dee6678eb3"><div class="jsx-5a195dee6678eb3"><a class="jsx-5a195dee6678eb3" href="/"><h1 class="jsx-5a195dee6678eb3">Radi&#x27;s Blog</h1></a></div></header><main class="jsx-5a195dee6678eb3"><div class="jsx-eb7a88ca53252729 post"><header class="jsx-eb7a88ca53252729"><h1 class="jsx-eb7a88ca53252729">Auto Version Control Your Files with incron</h1><span class="jsx-fdefdd4b6c4ce2c4"><time dateTime="2022-07-24T00:00:00.000Z" class="jsx-fdefdd4b6c4ce2c4">24 July 2022</time></span></header><p>This article&#x27;s intention is to provide instructions on setting auto version control for a given location. If you want to learn more about <code style="font-size:1rem;color:crimson">incron</code> I suggest you visit the <a href="https://inotify.aiken.cz/?section=incron&amp;page=doc&amp;lang=en">official page</a> and <a href="https://github.com/ar-/incron">github</a>.</p>
<p>If you want to follow along I have prepared a <code style="font-size:1rem;color:crimson">Dockerfile</code> you can use to build an image, you can then use to spin a container:<br/>
<!-- -->&lt;sub&gt;<!-- -->ℹ️ you should have <a href="https://docs.docker.com/get-docker/">Docker</a> installed<!-- -->&lt;/sub&gt;</p>
<pre><div style="color:white;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;background:#011627"><code class="language-dockerfile" style="color:#d6deeb;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token instruction" style="color:rgb(127, 219, 202)">FROM</span><span class="token instruction"> ubuntu:22.04</span><span>
</span><span></span><span class="token instruction" style="color:rgb(127, 219, 202)">RUN</span><span class="token instruction"> apt-get update</span><span>
</span><span></span><span class="token instruction" style="color:rgb(127, 219, 202)">RUN</span><span class="token instruction"> apt-get -y install incron</span><span>
</span><span></span><span class="token instruction" style="color:rgb(127, 219, 202)">RUN</span><span class="token instruction"> apt-get -y install git</span></code></div></pre>
<p>After you save the file run the following:</p>
<pre><div style="color:white;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;background:#011627"><code class="language-bash" style="color:#d6deeb;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:rgb(99, 119, 119);font-style:italic"># Create image</span><span>
</span><span></span><span class="token" style="color:rgb(130, 170, 255)">docker</span><span> build -t auto-version-control-demo </span><span class="token" style="color:rgb(255, 203, 139)">.</span><span>
</span><span></span><span class="token" style="color:rgb(99, 119, 119);font-style:italic">#Start and enter in container</span><span>
</span><span></span><span class="token" style="color:rgb(130, 170, 255)">docker</span><span> run -it --entrypoint </span><span class="token" style="color:rgb(130, 170, 255)">bash</span><span> auto-version-control-demo</span></code></div></pre>
<p>I&#x27;ve given my image the name of <code style="font-size:1rem;color:crimson">auto-version-control-demo</code>, you can call yours whatever you like.</p>
<p>By now you are already in the running container, <code style="font-size:1rem;color:crimson">incron</code> is installed and you just have to update <code style="font-size:1rem;color:crimson">/etc/incron.allow</code> before starting the service:</p>
<pre><div style="color:white;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;background:#011627"><code class="language-bash" style="color:#d6deeb;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:rgb(255, 203, 139)">echo</span><span> </span><span class="token" style="color:rgb(173, 219, 103)">&#x27;root&#x27;</span><span> </span><span class="token" style="color:rgb(127, 219, 202)">&gt;&gt;</span><span> /etc/incron.allow</span></code></div></pre>
<p>Now you can start the service:</p>
<pre><div style="color:white;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;background:#011627"><code class="language-bash" style="color:#d6deeb;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>/etc/init.d/incron start
</span>* Starting File system events scheduler</code></div></pre>
<p>Your <code style="font-size:1rem;color:crimson">incron</code> service is running now. You can confirm by:</p>
<pre><div style="color:white;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;background:#011627"><code class="language-bash" style="color:#d6deeb;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>/etc/init.d/incron status
</span>* incron is running</code></div></pre>
<p>After the start of the service we have to create a new entry for the <code style="font-size:1rem;color:crimson">root</code> user. Currently there are none:</p>
<pre><div style="color:white;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;background:#011627"><code class="language-bash" style="color:#d6deeb;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>incrontab -l
</span><span>no table </span><span class="token" style="color:rgb(127, 219, 202)">for</span><span> root</span></code></div></pre>
<p>To create new entry we need the following:</p>
<pre><div style="color:white;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;background:#011627"><code class="language-bash" style="color:#d6deeb;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:rgb(127, 219, 202)">&lt;</span><span>path</span><span class="token" style="color:rgb(127, 219, 202)">&gt;</span><span>  </span><span class="token" style="color:rgb(127, 219, 202)">&lt;</span><span>mask</span><span class="token" style="color:rgb(127, 219, 202)">&gt;</span><span>  </span><span class="token" style="color:rgb(127, 219, 202)">&lt;</span><span>command</span><span class="token" style="color:rgb(127, 219, 202)">&gt;</span></code></div></pre>
<p>Where <code style="font-size:1rem;color:crimson">path</code> is the location of the file or folder on the machine we want to monitor, the <code style="font-size:1rem;color:crimson">mask</code> is the event we want to listen for and the <code style="font-size:1rem;color:crimson">command</code> is the action we want to apply. In this demo we want to monitor the <code style="font-size:1rem;color:crimson">/cdn/content</code> folder. The events we want to listen for are <code style="font-size:1rem;color:crimson">IN_MODIFY,IN_CREATE,IN_DELETE,IN_MOVE</code> and we want to run the commands from a bash script which we&#x27;ll call <code style="font-size:1rem;color:crimson">cdn-auto-version.sh</code> and place in the <code style="font-size:1rem;color:crimson">/</code> root folder. This will be the content of the <code style="font-size:1rem;color:crimson">cdn-auto-version.sh</code>:</p>
<pre><div style="color:white;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;background:#011627"><code class="language-bash" style="color:#d6deeb;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token shebang" style="color:rgb(214, 222, 235);font-weight:bold">#!/bin/bash</span><span>
</span>
<span></span><span class="token assign-left" style="color:rgb(214, 222, 235)">PROJECT_FOLDER</span><span class="token" style="color:rgb(127, 219, 202)">=</span><span>/cdn/content
</span>
<span></span><span class="token" style="color:rgb(255, 203, 139)">cd</span><span> </span><span class="token" style="color:rgb(214, 222, 235)">$PROJECT_FOLDER</span><span>
</span><span></span><span class="token" style="color:rgb(130, 170, 255)">git</span><span> pull
</span><span></span><span class="token" style="color:rgb(130, 170, 255)">git</span><span> </span><span class="token" style="color:rgb(130, 170, 255)">add</span><span> </span><span class="token" style="color:rgb(255, 203, 139)">.</span><span>
</span><span></span><span class="token" style="color:rgb(130, 170, 255)">git</span><span> commit -m </span><span class="token" style="color:rgb(173, 219, 103)">&quot;Updated on </span><span class="token" style="color:rgb(214, 222, 235)">$(</span><span class="token" style="color:rgb(130, 170, 255)">date</span><span class="token" style="color:rgb(214, 222, 235)"> +</span><span class="token" style="color:rgb(214, 222, 235)">&#x27;%d-%m-%y&#x27;</span><span class="token" style="color:rgb(214, 222, 235)">)</span><span class="token" style="color:rgb(173, 219, 103)"> at </span><span class="token" style="color:rgb(214, 222, 235)">$(</span><span class="token" style="color:rgb(130, 170, 255)">date</span><span class="token" style="color:rgb(214, 222, 235)"> +</span><span class="token" style="color:rgb(214, 222, 235)">&#x27;%T&#x27;</span><span class="token" style="color:rgb(214, 222, 235)">)</span><span class="token" style="color:rgb(173, 219, 103)"> UTC&quot;</span><span>
</span><span></span><span class="token" style="color:rgb(130, 170, 255)">git</span><span> push</span></code></div></pre>
<p>Next we have to make the script executable. Make sure you&#x27;re in the root folder:</p>
<pre><div style="color:white;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;background:#011627"><code class="language-bash" style="color:#d6deeb;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:rgb(255, 203, 139)">cd</span><span> /
</span><span></span><span class="token" style="color:rgb(130, 170, 255)">chmod</span><span> </span><span class="token" style="color:rgb(247, 140, 108)">755</span><span> cdn-auto-version.sh</span></code></div></pre>
<p>ℹ️ You will also have to add ssh keys in <code style="font-size:1rem;color:crimson">/.ssh</code> for the repository you will be working with. I am not going to touch on this in the article but there is plenty of material in Google on how to do this.</p>
<p>With all this done we are ready to create our <code style="font-size:1rem;color:crimson">incrontab</code> entry. Execute</p>
<pre><div style="color:white;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;background:#011627"><code class="language-bash" style="color:#d6deeb;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>incrontab -e</span></code></div></pre>
<p>This will open the vim text editor. Press the <code style="font-size:1rem;color:crimson">i</code> key an paste:</p>
<pre><div style="color:white;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;background:#011627"><code class="language-bash" style="color:#d6deeb;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>/cdn/content IN_MODIFY,IN_CREATE,IN_DELETE,IN_MOVE /cdn-auto-version.sh</span></code></div></pre>
<p>Hit <code style="font-size:1rem;color:crimson">Esc</code> and then type <code style="font-size:1rem;color:crimson">:x</code> and <code style="font-size:1rem;color:crimson">Enter</code>. This will save your changes:</p>
<pre><div style="color:white;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;background:#011627"><code class="language-bash" style="color:#d6deeb;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>table updated</span></code></div></pre>
<p>To ensure you have updated the table:</p>
<pre><div style="color:white;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;background:#011627"><code class="language-bash" style="color:#d6deeb;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>incrontab  -l
</span>/cdn/content	IN_MODIFY,IN_CREATE,IN_DELETE,IN_MOVE	/cdn-auto-version.sh</code></div></pre>
<p>With this <code style="font-size:1rem;color:crimson">/cdn/content</code> will automatically update the remote repo you&#x27;ve set up every time there are changes to the files or folders within.</p>
<p>I have used this post as a reference on how to set up and work with <code style="font-size:1rem;color:crimson">incron</code>:<br/>
<!-- -->https://www.geeksforgeeks.org/incron-command-in-linux-with-examples/</p><footer class="jsx-eb7a88ca53252729"><div class="jsx-7814f24efc48ee15 list-categories"><a class="jsx-7814f24efc48ee15" href="/categories/devops">devops</a><a class="jsx-7814f24efc48ee15" href="/categories/github">github</a></div><a class="jsx-eb7a88ca53252729 go-back" href="/">🏠</a></footer></div></main></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"id":"auto-version-control-your-files-with-incron","title":"Auto Version Control Your Files with incron","date":"2022-07-24T00:00:00.000Z","description":"Read this article if you want to trigger git push to remote repo when files change in a specified location.","categories":["devops","github"],"markdown":"\nThis article's intention is to provide instructions on setting auto version control for a given location. If you want to learn more about `incron` I suggest you visit the [official page](https://inotify.aiken.cz/?section=incron\u0026page=doc\u0026lang=en) and [github](https://github.com/ar-/incron).\n\nIf you want to follow along I have prepared a `Dockerfile` you can use to build an image, you can then use to spin a container:  \n\u003csub\u003eℹ️ you should have [Docker](https://docs.docker.com/get-docker/) installed\u003c/sub\u003e\n\n```dockerfile\nFROM ubuntu:22.04\nRUN apt-get update\nRUN apt-get -y install incron\nRUN apt-get -y install git\n```\n\nAfter you save the file run the following:\n\n```bash\n# Create image\ndocker build -t auto-version-control-demo .\n#Start and enter in container\ndocker run -it --entrypoint bash auto-version-control-demo\n```\n\nI've given my image the name of `auto-version-control-demo`, you can call yours whatever you like.\n\nBy now you are already in the running container, `incron` is installed and you just have to update `/etc/incron.allow` before starting the service:\n\n```bash\necho 'root' \u003e\u003e /etc/incron.allow\n```\n\nNow you can start the service:\n\n```bash\n/etc/init.d/incron start\n* Starting File system events scheduler\n```\n\nYour `incron` service is running now. You can confirm by:\n\n```bash\n/etc/init.d/incron status\n* incron is running\n```\n\nAfter the start of the service we have to create a new entry for the `root` user. Currently there are none:\n\n```bash\nincrontab -l\nno table for root\n```\n\nTo create new entry we need the following:\n\n```bash\n\u003cpath\u003e  \u003cmask\u003e  \u003ccommand\u003e\n```\n\nWhere `path` is the location of the file or folder on the machine we want to monitor, the `mask` is the event we want to listen for and the `command` is the action we want to apply. In this demo we want to monitor the `/cdn/content` folder. The events we want to listen for are `IN_MODIFY,IN_CREATE,IN_DELETE,IN_MOVE` and we want to run the commands from a bash script which we'll call `cdn-auto-version.sh` and place in the `/` root folder. This will be the content of the `cdn-auto-version.sh`:\n\n```bash\n#!/bin/bash\n\nPROJECT_FOLDER=/cdn/content\n\ncd $PROJECT_FOLDER\ngit pull\ngit add .\ngit commit -m \"Updated on $(date +'%d-%m-%y') at $(date +'%T') UTC\"\ngit push\n```\n\nNext we have to make the script executable. Make sure you're in the root folder:\n\n```bash\ncd /\nchmod 755 cdn-auto-version.sh\n```\n\nℹ️ You will also have to add ssh keys in `/.ssh` for the repository you will be working with. I am not going to touch on this in the article but there is plenty of material in Google on how to do this.\n\nWith all this done we are ready to create our `incrontab` entry. Execute\n\n```bash\nincrontab -e\n```\n\nThis will open the vim text editor. Press the `i` key an paste:\n\n```bash\n/cdn/content IN_MODIFY,IN_CREATE,IN_DELETE,IN_MOVE /cdn-auto-version.sh\n```\n\nHit `Esc` and then type `:x` and `Enter`. This will save your changes:\n\n```bash\ntable updated\n```\n\nTo ensure you have updated the table:\n\n```bash\nincrontab  -l\n/cdn/content\tIN_MODIFY,IN_CREATE,IN_DELETE,IN_MOVE\t/cdn-auto-version.sh\n```\n\nWith this `/cdn/content` will automatically update the remote repo you've set up every time there are changes to the files or folders within.\n\nI have used this post as a reference on how to set up and work with `incron`:  \nhttps://www.geeksforgeeks.org/incron-command-in-linux-with-examples/\n"}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"auto-version-control-your-files-with-incron"},"buildId":"2pUE-tzp7EsMDGnqIcye_","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>