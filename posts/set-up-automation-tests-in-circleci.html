<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><meta name="og:title" content="Set up automation tests in CircleCI" class="jsx-ab3c345a5c4d0af2"/><title class="jsx-ab3c345a5c4d0af2">Set up automation tests in CircleCI</title><meta name="next-head-count" content="4"/><link rel="icon" href="/favicon/favicon.ico"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="true"/><meta name="description" content="A collection of technical posts."/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-1dfbbbf9a9fc5762.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-f65e66e62fc5ca80.js" defer=""></script><script src="/_next/static/chunks/pages/_app-02d0f4839caa4a8e.js" defer=""></script><script src="/_next/static/chunks/36-1dbe0f1c605fe40d.js" defer=""></script><script src="/_next/static/chunks/124-c054fb8e50bcf3db.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-b827ebe5f8f38b71.js" defer=""></script><script src="/_next/static/mE7KzKri9wqOQRXPl0qj8/_buildManifest.js" defer=""></script><script src="/_next/static/mE7KzKri9wqOQRXPl0qj8/_ssgManifest.js" defer=""></script><script src="/_next/static/mE7KzKri9wqOQRXPl0qj8/_middlewareManifest.js" defer=""></script><style id="__jsx-8798ecd94eff2422">.theme-toggle.jsx-8798ecd94eff2422{background:transparent;border:1px solid var(--border-color);cursor:pointer;padding:.5rem;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;color:var(--text-primary);display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-transition:all.2s ease;-moz-transition:all.2s ease;-o-transition:all.2s ease;transition:all.2s ease}.theme-toggle.jsx-8798ecd94eff2422:hover{background:var(--bg-secondary);color:var(--accent-primary);border-color:var(--accent-primary)}</style><style id="__jsx-1866830d1576afe2">span.jsx-1866830d1576afe2{color:var(--text-secondary);font-size:.85rem;display:block;margin-bottom:.5rem}</style><style id="__jsx-b585e1fe3ef5cb2f">.list-categories.jsx-b585e1fe3ef5cb2f{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;gap:.5rem;margin-bottom:1rem}.list-categories.jsx-b585e1fe3ef5cb2f a.jsx-b585e1fe3ef5cb2f{color:var(--accent-primary);background:var(--accent-glow);padding:.25rem .75rem;-webkit-border-radius:9999px;-moz-border-radius:9999px;border-radius:9999px;text-transform:uppercase;font-size:.7rem;font-weight:700;letter-spacing:.05em;-webkit-transition:all.2s ease;-moz-transition:all.2s ease;-o-transition:all.2s ease;transition:all.2s ease}.list-categories.jsx-b585e1fe3ef5cb2f a.jsx-b585e1fe3ef5cb2f:hover{-webkit-filter:brightness(1.1);filter:brightness(1.1);-webkit-transform:translateY(-1px);-moz-transform:translateY(-1px);-ms-transform:translateY(-1px);-o-transform:translateY(-1px);transform:translateY(-1px)}</style><style id="__jsx-ab3c345a5c4d0af2">.post.jsx-ab3c345a5c4d0af2{width:100%;-webkit-animation:fadeIn.5s ease-in-out;-moz-animation:fadeIn.5s ease-in-out;-o-animation:fadeIn.5s ease-in-out;animation:fadeIn.5s ease-in-out}@-webkit-keyframes fadeIn{from{opacity:0;-webkit-transform:translateY(10px);transform:translateY(10px)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}@-moz-keyframes fadeIn{from{opacity:0;-moz-transform:translateY(10px);transform:translateY(10px)}to{opacity:1;-moz-transform:translateY(0);transform:translateY(0)}}@-o-keyframes fadeIn{from{opacity:0;-o-transform:translateY(10px);transform:translateY(10px)}to{opacity:1;-o-transform:translateY(0);transform:translateY(0)}}@keyframes fadeIn{from{opacity:0;-webkit-transform:translateY(10px);-moz-transform:translateY(10px);-o-transform:translateY(10px);transform:translateY(10px)}to{opacity:1;-webkit-transform:translateY(0);-moz-transform:translateY(0);-o-transform:translateY(0);transform:translateY(0)}}header.jsx-ab3c345a5c4d0af2{text-align:center;margin-bottom:4rem;padding-bottom:2rem;border-bottom:1px solid var(--border-color)}.post.jsx-ab3c345a5c4d0af2 h1.jsx-ab3c345a5c4d0af2{margin-bottom:1rem;font-size:3rem;background:-webkit-linear-gradient(315deg,var(--text-primary),var(--text-secondary));background:-moz-linear-gradient(315deg,var(--text-primary),var(--text-secondary));background:-o-linear-gradient(315deg,var(--text-primary),var(--text-secondary));background:linear-gradient(135deg,var(--text-primary),var(--text-secondary));-webkit-background-clip:text;-webkit-text-fill-color:transparent}footer.jsx-ab3c345a5c4d0af2{margin-top:4rem;padding-top:2rem;border-top:1px solid var(--border-color);display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center}footer.jsx-ab3c345a5c4d0af2 a.go-back.jsx-ab3c345a5c4d0af2{font-size:1.2rem;padding:.5rem 1rem;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;background:var(--bg-secondary);-webkit-transition:all.2s ease;-moz-transition:all.2s ease;-o-transition:all.2s ease;transition:all.2s ease}footer.jsx-ab3c345a5c4d0af2 a.go-back.jsx-ab3c345a5c4d0af2:hover{background:var(--accent-glow);-webkit-transform:translateX(-4px);-moz-transform:translateX(-4px);-ms-transform:translateX(-4px);-o-transform:translateX(-4px);transform:translateX(-4px)}@media(max-width:640px){.post.jsx-ab3c345a5c4d0af2 h1.jsx-ab3c345a5c4d0af2{font-size:2rem}header.jsx-ab3c345a5c4d0af2{margin-bottom:2rem}}</style><style id="__jsx-f99e11a87ea866e1">:root{--bg-primary:#ffffff;--bg-secondary:#f8fafc;--bg-card:#ffffff;--text-primary:#0f172a;--text-secondary:#475569;--accent-primary:#0284c7;--accent-glow:rgba(2, 132, 199, 0.15);--border-color:#e2e8f0;--font-heading:'Outfit', sans-serif;--font-body:'Inter', sans-serif}[data-theme="dark"]{--bg-primary:#0f172a;--bg-secondary:#1e293b;--bg-card:rgba(30, 41, 59, 0.7);--text-primary:#f1f5f9;--text-secondary:#94a3b8;--accent-primary:#38bdf8;--accent-glow:rgba(56, 189, 248, 0.3);--border-color:rgba(148, 163, 184, 0.1)}html,body{padding:0;margin:0;font-family:var(--font-body);font-size:18px;background-color:var(--bg-primary);color:var(--text-primary);line-height:1.6;-webkit-transition:background-color.3s ease,color.3s ease;-moz-transition:background-color.3s ease,color.3s ease;-o-transition:background-color.3s ease,color.3s ease;transition:background-color.3s ease,color.3s ease}*{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}h1,h2,h3,h4,h5,h6{font-family:var(--font-heading);color:var(--text-primary);margin-top:0;line-height:1.2}h1{font-size:2.5rem;font-weight:800;letter-spacing:-.02em}h2{font-size:2rem;font-weight:700;letter-spacing:-.01em;margin-top:2rem}h3{font-size:1.5rem;font-weight:600;margin-top:1.5rem}p{margin-bottom:1.5rem;color:var(--text-secondary)}a{color:var(--accent-primary);text-decoration:none;-webkit-transition:color.2s ease;-moz-transition:color.2s ease;-o-transition:color.2s ease;transition:color.2s ease}a:hover{color:var(--text-primary)}img{max-width:100%;height:auto;-webkit-border-radius:12px;-moz-border-radius:12px;border-radius:12px;-webkit-box-shadow:0 4px 6px -1px rgba(0,0,0,.1),0 2px 4px -1px rgba(0,0,0,.06);-moz-box-shadow:0 4px 6px -1px rgba(0,0,0,.1),0 2px 4px -1px rgba(0,0,0,.06);box-shadow:0 4px 6px -1px rgba(0,0,0,.1),0 2px 4px -1px rgba(0,0,0,.06)}img[src*="#center"]{display:block;margin:2rem auto}.markdown-alert{padding:1rem 1.5rem;margin-bottom:1.5rem;border-left:4px solid;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;background-color:var(--bg-secondary)}.markdown-alert-note{border-color:var(--accent-primary);background:var(--accent-glow)}.markdown-alert-note .markdown-alert-title{color:var(--accent-primary)}.markdown-alert-tip{border-color:#22c55e;background:rgba(34,197,94,.1)}.markdown-alert-tip .markdown-alert-title{color:#22c55e}.markdown-alert-important{border-color:#a855f7;background:rgba(168,85,247,.1)}.markdown-alert-important .markdown-alert-title{color:#a855f7}.markdown-alert-warning{border-color:#f59e0b;background:rgba(245,158,11,.1)}.markdown-alert-warning .markdown-alert-title{color:#f59e0b}.markdown-alert-caution{border-color:#ef4444;background:rgba(239,68,68,.1)}.markdown-alert-caution .markdown-alert-title{color:#ef4444}.markdown-alert-title{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;font-weight:700;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;margin-bottom:.5rem;font-family:var(--font-heading)}.markdown-alert-title svg{margin-right:8px}pre{background:var(--bg-secondary)!important;-webkit-border-radius:12px;-moz-border-radius:12px;border-radius:12px;padding:1.5rem!important;overflow-x:auto;border:1px solid var(--border-color)}code{font-family:"Menlo","Monaco","Courier New",monospace;font-size:.9em}</style><style id="__jsx-312b8a00e43d9b3e">.layout-container.jsx-1c4561a41a36cd38{min-height:100vh;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;background-color:var(--bg-primary);-webkit-transition:background-color.3s ease;-moz-transition:background-color.3s ease;-o-transition:background-color.3s ease;transition:background-color.3s ease}.site-header.jsx-1c4561a41a36cd38{position:-webkit-sticky;position:sticky;top:0;z-index:100;width:100%;backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);background-color:var(--bg-primary);border-bottom:1px solid var(--border-color);-webkit-transition:background-color.3s ease,border-color.3s ease;-moz-transition:background-color.3s ease,border-color.3s ease;-o-transition:background-color.3s ease,border-color.3s ease;transition:background-color.3s ease,border-color.3s ease}[data-theme="dark"].jsx-1c4561a41a36cd38 .site-header.jsx-1c4561a41a36cd38{background-color:rgba(15,23,42,.8)}.jsx-1c4561a41a36cd38:root:not([data-theme="dark"]) .site-header.jsx-1c4561a41a36cd38{background-color:rgba(255,255,255,.8)}.header-content.jsx-1c4561a41a36cd38{max-width:900px;margin:0 auto;padding:1rem 1.5rem;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center}.logo.jsx-1c4561a41a36cd38 h1.jsx-1c4561a41a36cd38{font-size:1.5rem;margin:0;background:-webkit-linear-gradient(315deg,var(--accent-primary),#a855f7);background:-moz-linear-gradient(315deg,var(--accent-primary),#a855f7);background:-o-linear-gradient(315deg,var(--accent-primary),#a855f7);background:linear-gradient(135deg,var(--accent-primary),#a855f7);-webkit-background-clip:text;-webkit-text-fill-color:transparent;font-weight:800}.logo.jsx-1c4561a41a36cd38{text-decoration:none}main.jsx-1c4561a41a36cd38{-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1;width:100%;max-width:900px;margin:0 auto;padding:2rem 1.5rem}.site-footer.jsx-1c4561a41a36cd38{text-align:center;padding:2rem;color:var(--text-secondary);font-size:.9rem;border-top:1px solid var(--border-color);margin-top:4rem}@media(max-width:640px){html.jsx-1c4561a41a36cd38{font-size:16px}h1.jsx-1c4561a41a36cd38{font-size:2rem}main.jsx-1c4561a41a36cd38{padding:1.5rem 1rem}}</style><style data-href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Outfit:wght@400;500;600;700;800&display=swap">@font-face{font-family:'Inter';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/l/font?kit=UcCO3FwrK3iLTeHuS_nVMrMxCp50SjIw2boKoduKmMEVuOKfMZs&skey=c491285d6722e4fa&v=v20) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/l/font?kit=UcCO3FwrK3iLTeHuS_nVMrMxCp50SjIw2boKoduKmMEVuLyfMZs&skey=c491285d6722e4fa&v=v20) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/l/font?kit=UcCO3FwrK3iLTeHuS_nVMrMxCp50SjIw2boKoduKmMEVuI6fMZs&skey=c491285d6722e4fa&v=v20) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/l/font?kit=UcCO3FwrK3iLTeHuS_nVMrMxCp50SjIw2boKoduKmMEVuGKYMZs&skey=c491285d6722e4fa&v=v20) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/l/font?kit=UcCO3FwrK3iLTeHuS_nVMrMxCp50SjIw2boKoduKmMEVuFuYMZs&skey=c491285d6722e4fa&v=v20) format('woff')}@font-face{font-family:'Outfit';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/l/font?kit=QGYyz_MVcBeNP4NjuGObqx1XmO1I4TC1C4I&skey=bafc0b239d492b2c&v=v15) format('woff')}@font-face{font-family:'Outfit';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/l/font?kit=QGYyz_MVcBeNP4NjuGObqx1XmO1I4QK1C4I&skey=bafc0b239d492b2c&v=v15) format('woff')}@font-face{font-family:'Outfit';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/l/font?kit=QGYyz_MVcBeNP4NjuGObqx1XmO1I4e6yC4I&skey=bafc0b239d492b2c&v=v15) format('woff')}@font-face{font-family:'Outfit';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/l/font?kit=QGYyz_MVcBeNP4NjuGObqx1XmO1I4deyC4I&skey=bafc0b239d492b2c&v=v15) format('woff')}@font-face{font-family:'Outfit';font-style:normal;font-weight:800;font-display:swap;src:url(https://fonts.gstatic.com/l/font?kit=QGYyz_MVcBeNP4NjuGObqx1XmO1I4bCyC4I&skey=bafc0b239d492b2c&v=v15) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Outfit';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/outfit/v15/QGYvz_MVcBeNP4NJuktqUYLkn8BJ.woff2) format('woff2');unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Outfit';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/outfit/v15/QGYvz_MVcBeNP4NJtEtqUYLknw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Outfit';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/outfit/v15/QGYvz_MVcBeNP4NJuktqUYLkn8BJ.woff2) format('woff2');unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Outfit';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/outfit/v15/QGYvz_MVcBeNP4NJtEtqUYLknw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Outfit';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/outfit/v15/QGYvz_MVcBeNP4NJuktqUYLkn8BJ.woff2) format('woff2');unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Outfit';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/outfit/v15/QGYvz_MVcBeNP4NJtEtqUYLknw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Outfit';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/outfit/v15/QGYvz_MVcBeNP4NJuktqUYLkn8BJ.woff2) format('woff2');unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Outfit';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/outfit/v15/QGYvz_MVcBeNP4NJtEtqUYLknw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Outfit';font-style:normal;font-weight:800;font-display:swap;src:url(https://fonts.gstatic.com/s/outfit/v15/QGYvz_MVcBeNP4NJuktqUYLkn8BJ.woff2) format('woff2');unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Outfit';font-style:normal;font-weight:800;font-display:swap;src:url(https://fonts.gstatic.com/s/outfit/v15/QGYvz_MVcBeNP4NJtEtqUYLknw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body><div id="__next" data-reactroot=""><div class="jsx-1c4561a41a36cd38 layout-container"><header class="jsx-1c4561a41a36cd38 site-header"><div class="jsx-1c4561a41a36cd38 header-content"><a class="jsx-1c4561a41a36cd38 logo" href="/"><h1 class="jsx-1c4561a41a36cd38">Radi&#x27;s Blog</h1></a><button aria-label="Switch to light mode" class="jsx-8798ecd94eff2422 theme-toggle"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="jsx-8798ecd94eff2422"><circle cx="12" cy="12" r="5" class="jsx-8798ecd94eff2422"></circle><line x1="12" y1="1" x2="12" y2="3" class="jsx-8798ecd94eff2422"></line><line x1="12" y1="21" x2="12" y2="23" class="jsx-8798ecd94eff2422"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64" class="jsx-8798ecd94eff2422"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78" class="jsx-8798ecd94eff2422"></line><line x1="1" y1="12" x2="3" y2="12" class="jsx-8798ecd94eff2422"></line><line x1="21" y1="12" x2="23" y2="12" class="jsx-8798ecd94eff2422"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36" class="jsx-8798ecd94eff2422"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22" class="jsx-8798ecd94eff2422"></line></svg></button></div></header><main class="jsx-1c4561a41a36cd38"><div class="jsx-ab3c345a5c4d0af2 post"><header class="jsx-ab3c345a5c4d0af2"><h1 class="jsx-ab3c345a5c4d0af2">Set up automation tests in CircleCI</h1><span class="jsx-1866830d1576afe2"><time dateTime="2018-12-09T00:00:00.000Z" class="jsx-1866830d1576afe2">9 December 2018</time></span></header><p>Recently the company I work for moved the CI/CD from Shippable to CircleCI. This is a quick guide on how to create a job and workflow.I have created two different workflows for my needs . One called <strong>nightly</strong> running all tests from the feature tests repo every day from Monday to Friday at 4am and one used externally from the application under test workflow called <strong>feature-tests</strong>.</p>
<h2>Nightly</h2>
<p>First create the job. I have called mine tests. Then I specified the base docker image I want to use for the job, i.e. <code style="font-size:0.9em;color:var(--accent-primary);background:var(--accent-glow);padding:0.2em 0.4em;border-radius:4px;font-family:Menlo, Monaco, monospace">circleci/ruby:2.5-browsers-legacy</code>. I won&#x27;t go in too much detail for all the steps because they will be generated automatically for you once you add you automation tests in CircleCI (for more information see <a href="https://circleci.com/docs/2.0/project-build/#section=getting-started">here</a>). The most important thing to know about the job is that you&#x27;ll have to use bundle install cucumber instead of just cucumber because all gems will be installed in a custom location <code style="font-size:0.9em;color:var(--accent-primary);background:var(--accent-glow);padding:0.2em 0.4em;border-radius:4px;font-family:Menlo, Monaco, monospace">bundle install --jobs=4 --retry=3 --path vendor/bundle</code>. The other tip is to specify the path where the test reports can be found after completion - <code style="font-size:0.9em;color:var(--accent-primary);background:var(--accent-glow);padding:0.2em 0.4em;border-radius:4px;font-family:Menlo, Monaco, monospace">store_test_results: path: /tmp</code>. Make sure the path set is the same as the one you have in <code style="font-size:0.9em;color:var(--accent-primary);background:var(--accent-glow);padding:0.2em 0.4em;border-radius:4px;font-family:Menlo, Monaco, monospace">cucumber.yml</code>. Also make sure the output format is junit so you can see the number of passing and failing tests at first glance in the tab <strong>Results</strong> after the job is finished.</p>
<pre><div style="position:relative" class="code-block-wrapper"><button aria-label="Copy code" style="position:absolute;top:8px;right:8px;z-index:1;padding:6px;color:#e2e8f0;background:rgba(255, 255, 255, 0.1);border:1px solid rgba(255, 255, 255, 0.2);border-radius:6px;cursor:pointer;transition:all 0.2s ease;display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button><div style="color:white;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;background:#011627"><code class="language-yml" style="color:#d6deeb;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:rgb(99, 119, 119);font-style:italic"># /.circleci/config.yml</span><span>
</span><span></span><span class="token" style="color:rgb(99, 119, 119);font-style:italic"># Ruby CircleCI 2.0 configuration file</span><span>
</span><span></span><span class="token" style="color:rgb(99, 119, 119);font-style:italic">#</span><span>
</span><span></span><span class="token" style="color:rgb(99, 119, 119);font-style:italic"># Check https://circleci.com/docs/2.0/language-ruby/ for more details</span><span>
</span><span></span><span class="token" style="color:rgb(99, 119, 119);font-style:italic">#</span><span>
</span><span></span><span class="token key" style="color:rgb(255, 203, 139)">jobs</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>  </span><span class="token key" style="color:rgb(255, 203, 139)">test</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>    </span><span class="token key" style="color:rgb(255, 203, 139)">docker</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>      </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> </span><span class="token key" style="color:rgb(255, 203, 139)">image</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> circleci/ruby</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>2.5</span><span class="token" style="color:rgb(199, 146, 234)">-</span><span>browsers</span><span class="token" style="color:rgb(199, 146, 234)">-</span><span>legacy
</span><span>    </span><span class="token key" style="color:rgb(255, 203, 139)">working_directory</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> ~/repo
</span><span>    </span><span class="token key" style="color:rgb(255, 203, 139)">steps</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>      </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> checkout
</span><span>      </span><span class="token" style="color:rgb(99, 119, 119);font-style:italic"># Download and cache dependencies</span><span>
</span><span>      </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> </span><span class="token key" style="color:rgb(255, 203, 139)">restore_cache</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">keys</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>            </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> v1</span><span class="token" style="color:rgb(199, 146, 234)">-</span><span>dependencies</span><span class="token" style="color:rgb(199, 146, 234)">-</span><span class="token" style="color:rgb(199, 146, 234)">{</span><span class="token" style="color:rgb(199, 146, 234)">{</span><span> checksum &quot;Gemfile.lock&quot; </span><span class="token" style="color:rgb(199, 146, 234)">}</span><span class="token" style="color:rgb(199, 146, 234)">}</span><span>
</span><span>            </span><span class="token" style="color:rgb(99, 119, 119);font-style:italic"># fallback to using the latest cache if no exact match is found</span><span>
</span><span>            </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> v1</span><span class="token" style="color:rgb(199, 146, 234)">-</span><span>dependencies</span><span class="token" style="color:rgb(199, 146, 234)">-</span><span>
</span>
<span>      </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> </span><span class="token key" style="color:rgb(255, 203, 139)">run</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">name</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> install dependencies
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">command</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> </span><span class="token" style="color:rgb(199, 146, 234)">|</span><span class="token scalar" style="color:rgb(173, 219, 103)">
</span><span class="token scalar" style="color:rgb(173, 219, 103)">            bundle install --jobs=4 --retry=3 --path vendor/bundle</span><span>
</span>
<span>      </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> </span><span class="token key" style="color:rgb(255, 203, 139)">save_cache</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">paths</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>            </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> ./vendor/bundle
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">key</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> v1</span><span class="token" style="color:rgb(199, 146, 234)">-</span><span>dependencies</span><span class="token" style="color:rgb(199, 146, 234)">-</span><span class="token" style="color:rgb(199, 146, 234)">{</span><span class="token" style="color:rgb(199, 146, 234)">{</span><span> checksum &quot;Gemfile.lock&quot; </span><span class="token" style="color:rgb(199, 146, 234)">}</span><span class="token" style="color:rgb(199, 146, 234)">}</span><span>
</span>
<span>      </span><span class="token" style="color:rgb(99, 119, 119);font-style:italic"># run tests!</span><span>
</span><span>      </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> </span><span class="token key" style="color:rgb(255, 203, 139)">run</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">name</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> run tests
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">command</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> </span><span class="token" style="color:rgb(199, 146, 234)">|</span><span class="token scalar" style="color:rgb(173, 219, 103)">
</span><span class="token scalar" style="color:rgb(173, 219, 103)">            bundle exec cucumber features/ -p remote LOCATION=GB</span><span>
</span>
<span>      </span><span class="token" style="color:rgb(99, 119, 119);font-style:italic"># collect reports</span><span>
</span><span>      </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> </span><span class="token key" style="color:rgb(255, 203, 139)">store_test_results</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">path</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> /tmp
</span><span>      </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> </span><span class="token key" style="color:rgb(255, 203, 139)">store_artifacts</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">path</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> /reports
</span>
<span></span><span class="token key" style="color:rgb(255, 203, 139)">workflows</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>  </span><span class="token key" style="color:rgb(255, 203, 139)">version</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> </span><span class="token" style="color:rgb(247, 140, 108)">2</span><span>
</span><span>  </span><span class="token key" style="color:rgb(255, 203, 139)">nightly</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>    </span><span class="token key" style="color:rgb(255, 203, 139)">triggers</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>      </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> </span><span class="token key" style="color:rgb(255, 203, 139)">schedule</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">cron</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> </span><span class="token" style="color:rgb(173, 219, 103)">&#x27;0 4 * * 1-5&#x27;</span><span>
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">filters</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>            </span><span class="token key" style="color:rgb(255, 203, 139)">branches</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>              </span><span class="token key" style="color:rgb(255, 203, 139)">only</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>                </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> master
</span><span>    </span><span class="token key" style="color:rgb(255, 203, 139)">jobs</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>      </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> </span><span class="token key" style="color:rgb(255, 203, 139)">test</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">context</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> featuretests</span></code></div></div></pre>
<p>After you finish with the job section, create nightly workflow that runs on a schedule. Set the time when the job should be triggered in the <code style="font-size:0.9em;color:var(--accent-primary);background:var(--accent-glow);padding:0.2em 0.4em;border-radius:4px;font-family:Menlo, Monaco, monospace">cron</code> field and set the branch with the code you want executed. In the <code style="font-size:0.9em;color:var(--accent-primary);background:var(--accent-glow);padding:0.2em 0.4em;border-radius:4px;font-family:Menlo, Monaco, monospace">job</code> field declare you want this workflow to run the job set up above, i.e. <code style="font-size:0.9em;color:var(--accent-primary);background:var(--accent-glow);padding:0.2em 0.4em;border-radius:4px;font-family:Menlo, Monaco, monospace">test</code> and in the <code style="font-size:0.9em;color:var(--accent-primary);background:var(--accent-glow);padding:0.2em 0.4em;border-radius:4px;font-family:Menlo, Monaco, monospace">context</code> field set the name set in CircleCI with all project secrets.</p>
<h2>Feature-tests</h2>
<p>Just like in the example above we start with creating job which we&#x27;ll use in the workflow section. But unlike in the previous example we won&#x27;t run the tests from their own repo but instead they&#x27;ll be called externally from the repository of the app we&#x27;re testing. My first attempt was to create steps to pull, bundle and execute tests but it failed because of the way CircleCI handles ssh keys. I have tried setting up the keys in a step as described in the docs but it didn&#x27;t work.</p>
<pre><div style="position:relative" class="code-block-wrapper"><button aria-label="Copy code" style="position:absolute;top:8px;right:8px;z-index:1;padding:6px;color:#e2e8f0;background:rgba(255, 255, 255, 0.1);border:1px solid rgba(255, 255, 255, 0.2);border-radius:6px;cursor:pointer;transition:all 0.2s ease;display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button><div style="color:white;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;background:#011627"><code class="language-yml" style="color:#d6deeb;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token key" style="color:rgb(255, 203, 139)">steps</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>  </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> </span><span class="token key" style="color:rgb(255, 203, 139)">add_ssh_keys</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>      </span><span class="token key" style="color:rgb(255, 203, 139)">fingerprints</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>        </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> </span><span class="token" style="color:rgb(173, 219, 103)">&#x27;SO:ME:FIN:G:ER:PR:IN:T&#x27;</span></code></div></div></pre>
<p>My assumption was that during build the job will use the ssh keys set in the circleci project secrets section if no fingerprints field present in the steps and once it gets to a step with fingerprints it will use the ones provided. It turns out that if there are ssh keys set CircleCI doesn&#x27;t look for any other and uses the same set for authentications. I already had a docker image for my tests and all I had to do was to pull my image and use it to spin a container for my tests. The rest of the steps are similar to the nightly example except the caching and installation of dependencies.</p>
<pre><div style="position:relative" class="code-block-wrapper"><button aria-label="Copy code" style="position:absolute;top:8px;right:8px;z-index:1;padding:6px;color:#e2e8f0;background:rgba(255, 255, 255, 0.1);border:1px solid rgba(255, 255, 255, 0.2);border-radius:6px;cursor:pointer;transition:all 0.2s ease;display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button><div style="color:white;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;background:#011627"><code class="language-yml" style="color:#d6deeb;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token key" style="color:rgb(255, 203, 139)">feature-tests</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>  </span><span class="token key" style="color:rgb(255, 203, 139)">docker</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>    </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> </span><span class="token key" style="color:rgb(255, 203, 139)">image</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> name</span><span class="token" style="color:rgb(199, 146, 234)">-</span><span>of</span><span class="token" style="color:rgb(199, 146, 234)">-</span><span>your</span><span class="token" style="color:rgb(199, 146, 234)">-</span><span>image.xxx.xxx.eu</span><span class="token" style="color:rgb(199, 146, 234)">-</span><span>west</span><span class="token" style="color:rgb(199, 146, 234)">-</span><span>1.amazonaws.com/feature</span><span class="token" style="color:rgb(199, 146, 234)">-</span><span>tests</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>latest
</span><span>  </span><span class="token key" style="color:rgb(255, 203, 139)">working_directory</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> /app
</span><span>  </span><span class="token key" style="color:rgb(255, 203, 139)">steps</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>    </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> </span><span class="token key" style="color:rgb(255, 203, 139)">run</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>        </span><span class="token key" style="color:rgb(255, 203, 139)">name</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> run tests
</span><span>        </span><span class="token key" style="color:rgb(255, 203, 139)">command</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> </span><span class="token" style="color:rgb(199, 146, 234)">|</span><span class="token scalar" style="color:rgb(173, 219, 103)">
</span><span class="token scalar" style="color:rgb(173, 219, 103)">          bundle exec cucumber features/app_under_test</span><span>
</span><span>    </span><span class="token" style="color:rgb(99, 119, 119);font-style:italic"># collect reports</span><span>
</span><span>    </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> </span><span class="token key" style="color:rgb(255, 203, 139)">store_test_results</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>        </span><span class="token key" style="color:rgb(255, 203, 139)">path</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> /tmp
</span><span>    </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> </span><span class="token key" style="color:rgb(255, 203, 139)">store_artifacts</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>        </span><span class="token key" style="color:rgb(255, 203, 139)">path</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> /reports</span></code></div></div></pre>
<p>Once the job was defined I was ready to include it in the project workflow. I wanted my tests to run once the application under test was deployed to staging. To do so I used the <code style="font-size:0.9em;color:var(--accent-primary);background:var(--accent-glow);padding:0.2em 0.4em;border-radius:4px;font-family:Menlo, Monaco, monospace">requires</code> field and set it up to <code style="font-size:0.9em;color:var(--accent-primary);background:var(--accent-glow);padding:0.2em 0.4em;border-radius:4px;font-family:Menlo, Monaco, monospace">deploy</code> and also specified in filters &gt; branches that I only want to run the tests when the application is deployed in staging.</p>
<pre><div style="position:relative" class="code-block-wrapper"><button aria-label="Copy code" style="position:absolute;top:8px;right:8px;z-index:1;padding:6px;color:#e2e8f0;background:rgba(255, 255, 255, 0.1);border:1px solid rgba(255, 255, 255, 0.2);border-radius:6px;cursor:pointer;transition:all 0.2s ease;display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button><div style="color:white;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;background:#011627"><code class="language-yml" style="color:#d6deeb;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:rgb(99, 119, 119);font-style:italic"># /.circleci/config.yml</span><span>
</span><span></span><span class="token key" style="color:rgb(255, 203, 139)">version</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> </span><span class="token" style="color:rgb(247, 140, 108)">2</span><span>
</span><span></span><span class="token key" style="color:rgb(255, 203, 139)">workflows</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>  </span><span class="token key" style="color:rgb(255, 203, 139)">version</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> </span><span class="token" style="color:rgb(247, 140, 108)">2</span><span>
</span><span>  </span><span class="token key" style="color:rgb(255, 203, 139)">build_test_deploy</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>    </span><span class="token key" style="color:rgb(255, 203, 139)">jobs</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>      </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> </span><span class="token key" style="color:rgb(255, 203, 139)">deploy</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">context</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> aws
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">filters</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>            </span><span class="token key" style="color:rgb(255, 203, 139)">branches</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>              </span><span class="token key" style="color:rgb(255, 203, 139)">only</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>                </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> staging
</span><span>                </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> production
</span><span>      </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> </span><span class="token key" style="color:rgb(255, 203, 139)">feature-tests</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">requires</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>            </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> deploy
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">context</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> featuretests
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">filters</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>            </span><span class="token key" style="color:rgb(255, 203, 139)">branches</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>              </span><span class="token key" style="color:rgb(255, 203, 139)">only</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>                </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> staging</span></code></div></div></pre>
<p>When you work on the config file be very careful with the indentation. Before trying your config live you can run validation if you have CircleCI&#x27;s cli installed, i.e. <code style="font-size:0.9em;color:var(--accent-primary);background:var(--accent-glow);padding:0.2em 0.4em;border-radius:4px;font-family:Menlo, Monaco, monospace">circleci config validate</code>. Using the cli you can also run the build locally. For more information go to <a href="https://circleci.com/docs/2.0/local-cli/">local-cli</a>.</p>
<p>Complete file <code style="font-size:0.9em;color:var(--accent-primary);background:var(--accent-glow);padding:0.2em 0.4em;border-radius:4px;font-family:Menlo, Monaco, monospace">config.yml</code>:</p>
<pre><div style="position:relative" class="code-block-wrapper"><button aria-label="Copy code" style="position:absolute;top:8px;right:8px;z-index:1;padding:6px;color:#e2e8f0;background:rgba(255, 255, 255, 0.1);border:1px solid rgba(255, 255, 255, 0.2);border-radius:6px;cursor:pointer;transition:all 0.2s ease;display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button><div style="color:white;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;background:#011627"><code class="language-yml" style="color:#d6deeb;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token key" style="color:rgb(255, 203, 139)">version</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> </span><span class="token" style="color:rgb(247, 140, 108)">2</span><span>
</span><span></span><span class="token key" style="color:rgb(255, 203, 139)">workflows</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>  </span><span class="token key" style="color:rgb(255, 203, 139)">version</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> </span><span class="token" style="color:rgb(247, 140, 108)">2</span><span>
</span><span>  </span><span class="token key" style="color:rgb(255, 203, 139)">build_test_deploy</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>    </span><span class="token key" style="color:rgb(255, 203, 139)">jobs</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>      </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> </span><span class="token key" style="color:rgb(255, 203, 139)">deploy</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">context</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> aws
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">filters</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>            </span><span class="token key" style="color:rgb(255, 203, 139)">branches</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>              </span><span class="token key" style="color:rgb(255, 203, 139)">only</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>                </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> staging
</span><span>                </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> production
</span><span>      </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> </span><span class="token key" style="color:rgb(255, 203, 139)">feature-tests</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">requires</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>            </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> deploy
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">context</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> featuretests
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">filters</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>            </span><span class="token key" style="color:rgb(255, 203, 139)">branches</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>              </span><span class="token key" style="color:rgb(255, 203, 139)">only</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>                </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> staging
</span><span></span><span class="token key" style="color:rgb(255, 203, 139)">jobs</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>  </span><span class="token key" style="color:rgb(255, 203, 139)">deploy</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>    </span><span class="token key" style="color:rgb(255, 203, 139)">docker</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>      </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> </span><span class="token key" style="color:rgb(255, 203, 139)">image</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> application</span><span class="token" style="color:rgb(199, 146, 234)">-</span><span>image.xxx.xxx.eu</span><span class="token" style="color:rgb(199, 146, 234)">-</span><span>west</span><span class="token" style="color:rgb(199, 146, 234)">-</span><span>1.amazonaws.com/node</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>latest
</span><span>    </span><span class="token key" style="color:rgb(255, 203, 139)">working_directory</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> ~/code
</span><span>    </span><span class="token key" style="color:rgb(255, 203, 139)">steps</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>      </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> checkout
</span><span>      </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> </span><span class="token key" style="color:rgb(255, 203, 139)">restore_cache</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> </span><span class="token" style="color:rgb(99, 119, 119);font-style:italic"># special step to restore the dependency cache</span><span>
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">key</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> dependency</span><span class="token" style="color:rgb(199, 146, 234)">-</span><span>cache</span><span class="token" style="color:rgb(199, 146, 234)">-</span><span class="token" style="color:rgb(199, 146, 234)">{</span><span class="token" style="color:rgb(199, 146, 234)">{</span><span> checksum &quot;yarn.lock&quot; </span><span class="token" style="color:rgb(199, 146, 234)">}</span><span class="token" style="color:rgb(199, 146, 234)">}</span><span>
</span><span>      </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> </span><span class="token key" style="color:rgb(255, 203, 139)">run</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">name</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> yarn
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">command</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> yarn </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span class="token" style="color:rgb(199, 146, 234)">-</span><span>no</span><span class="token" style="color:rgb(199, 146, 234)">-</span><span>progress
</span><span>      </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> </span><span class="token key" style="color:rgb(255, 203, 139)">save_cache</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> </span><span class="token" style="color:rgb(99, 119, 119);font-style:italic"># special step to save the dependency cache</span><span>
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">key</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> dependency</span><span class="token" style="color:rgb(199, 146, 234)">-</span><span>cache</span><span class="token" style="color:rgb(199, 146, 234)">-</span><span class="token" style="color:rgb(199, 146, 234)">{</span><span class="token" style="color:rgb(199, 146, 234)">{</span><span> checksum &quot;yarn.lock&quot; </span><span class="token" style="color:rgb(199, 146, 234)">}</span><span class="token" style="color:rgb(199, 146, 234)">}</span><span>
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">paths</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>            </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> ./node_modules
</span><span>      </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> </span><span class="token key" style="color:rgb(255, 203, 139)">run</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">name</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> node</span><span class="token" style="color:rgb(199, 146, 234)">-</span><span>sass
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">command</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> npm rebuild node</span><span class="token" style="color:rgb(199, 146, 234)">-</span><span>sass
</span><span>      </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> </span><span class="token key" style="color:rgb(255, 203, 139)">run</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">name</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> yarn test
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">command</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> yarn test
</span><span>      </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> </span><span class="token key" style="color:rgb(255, 203, 139)">run</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">name</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> yarn build
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">command</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> NODE_ENV=$CIRCLE_BRANCH yarn build
</span><span>      </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> </span><span class="token key" style="color:rgb(255, 203, 139)">run</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">name</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> deploy
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">command</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> ./deploy.sh
</span><span>  </span><span class="token key" style="color:rgb(255, 203, 139)">feature-tests</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>    </span><span class="token key" style="color:rgb(255, 203, 139)">docker</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>      </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> </span><span class="token key" style="color:rgb(255, 203, 139)">image</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> feat</span><span class="token" style="color:rgb(199, 146, 234)">-</span><span>tests</span><span class="token" style="color:rgb(199, 146, 234)">-</span><span>image.xxx.xxx.eu</span><span class="token" style="color:rgb(199, 146, 234)">-</span><span>west</span><span class="token" style="color:rgb(199, 146, 234)">-</span><span>1.amazonaws.com/feature</span><span class="token" style="color:rgb(199, 146, 234)">-</span><span>tests</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>latest
</span><span>    </span><span class="token key" style="color:rgb(255, 203, 139)">working_directory</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> /app
</span><span>    </span><span class="token key" style="color:rgb(255, 203, 139)">steps</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>      </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> </span><span class="token key" style="color:rgb(255, 203, 139)">run</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">name</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> run tests
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">command</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> </span><span class="token" style="color:rgb(199, 146, 234)">|</span><span class="token scalar" style="color:rgb(173, 219, 103)">
</span><span class="token scalar" style="color:rgb(173, 219, 103)">            bundle exec cucumber features/application_under_test</span><span>
</span><span>      </span><span class="token" style="color:rgb(99, 119, 119);font-style:italic"># collect reports</span><span>
</span><span>      </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> </span><span class="token key" style="color:rgb(255, 203, 139)">store_test_results</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">path</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> /tmp
</span><span>      </span><span class="token" style="color:rgb(199, 146, 234)">-</span><span> </span><span class="token key" style="color:rgb(255, 203, 139)">store_artifacts</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span>
</span><span>          </span><span class="token key" style="color:rgb(255, 203, 139)">path</span><span class="token" style="color:rgb(199, 146, 234)">:</span><span> /reports</span></code></div></div></pre><footer class="jsx-ab3c345a5c4d0af2"><div class="jsx-b585e1fe3ef5cb2f list-categories"><a class="jsx-b585e1fe3ef5cb2f" href="/categories/devops">devops</a><a class="jsx-b585e1fe3ef5cb2f" href="/categories/circleci">circleci</a><a class="jsx-b585e1fe3ef5cb2f" href="/categories/ruby">ruby</a></div><a class="jsx-ab3c345a5c4d0af2 go-back" href="/"></a></footer></div></main><footer class="jsx-1c4561a41a36cd38 site-footer"><p class="jsx-1c4561a41a36cd38"> <!-- -->2026<!-- --> Radi Totev. All rights reserved.</p></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"id":"set-up-automation-tests-in-circleci","title":"Set up automation tests in CircleCI","date":"2018-12-09T00:00:00.000Z","description":"Description of the work done integrating e2e test in the CircleCI CI/CD. Article contains also yaml file for each of the jobs discussed.","categories":["devops","circleci","ruby"],"markdown":"\nRecently the company I work for moved the CI/CD from Shippable to CircleCI. This is a quick guide on how to create a job and workflow.I have created two different workflows for my needs . One called **nightly** running all tests from the feature tests repo every day from Monday to Friday at 4am and one used externally from the application under test workflow called **feature-tests**.\n\n## Nightly\n\nFirst create the job. I have called mine tests. Then I specified the base docker image I want to use for the job, i.e. `circleci/ruby:2.5-browsers-legacy`. I won't go in too much detail for all the steps because they will be generated automatically for you once you add you automation tests in CircleCI (for more information see [here](https://circleci.com/docs/2.0/project-build/#section=getting-started)). The most important thing to know about the job is that you'll have to use bundle install cucumber instead of just cucumber because all gems will be installed in a custom location `bundle install --jobs=4 --retry=3 --path vendor/bundle`. The other tip is to specify the path where the test reports can be found after completion - `store_test_results: path: /tmp`. Make sure the path set is the same as the one you have in `cucumber.yml`. Also make sure the output format is junit so you can see the number of passing and failing tests at first glance in the tab **Results** after the job is finished.\n\n```yml\n# /.circleci/config.yml\n# Ruby CircleCI 2.0 configuration file\n#\n# Check https://circleci.com/docs/2.0/language-ruby/ for more details\n#\njobs:\n  test:\n    docker:\n      - image: circleci/ruby:2.5-browsers-legacy\n    working_directory: ~/repo\n    steps:\n      - checkout\n      # Download and cache dependencies\n      - restore_cache:\n          keys:\n            - v1-dependencies-{{ checksum \"Gemfile.lock\" }}\n            # fallback to using the latest cache if no exact match is found\n            - v1-dependencies-\n\n      - run:\n          name: install dependencies\n          command: |\n            bundle install --jobs=4 --retry=3 --path vendor/bundle\n\n      - save_cache:\n          paths:\n            - ./vendor/bundle\n          key: v1-dependencies-{{ checksum \"Gemfile.lock\" }}\n\n      # run tests!\n      - run:\n          name: run tests\n          command: |\n            bundle exec cucumber features/ -p remote LOCATION=GB\n\n      # collect reports\n      - store_test_results:\n          path: /tmp\n      - store_artifacts:\n          path: /reports\n\nworkflows:\n  version: 2\n  nightly:\n    triggers:\n      - schedule:\n          cron: '0 4 * * 1-5'\n          filters:\n            branches:\n              only:\n                - master\n    jobs:\n      - test:\n          context: featuretests\n```\n\nAfter you finish with the job section, create nightly workflow that runs on a schedule. Set the time when the job should be triggered in the `cron` field and set the branch with the code you want executed. In the `job` field declare you want this workflow to run the job set up above, i.e. `test` and in the `context` field set the name set in CircleCI with all project secrets.\n\n## Feature-tests\n\nJust like in the example above we start with creating job which we'll use in the workflow section. But unlike in the previous example we won't run the tests from their own repo but instead they'll be called externally from the repository of the app we're testing. My first attempt was to create steps to pull, bundle and execute tests but it failed because of the way CircleCI handles ssh keys. I have tried setting up the keys in a step as described in the docs but it didn't work.\n\n```yml\nsteps:\n  - add_ssh_keys:\n      fingerprints:\n        - 'SO:ME:FIN:G:ER:PR:IN:T'\n```\n\nMy assumption was that during build the job will use the ssh keys set in the circleci project secrets section if no fingerprints field present in the steps and once it gets to a step with fingerprints it will use the ones provided. It turns out that if there are ssh keys set CircleCI doesn't look for any other and uses the same set for authentications. I already had a docker image for my tests and all I had to do was to pull my image and use it to spin a container for my tests. The rest of the steps are similar to the nightly example except the caching and installation of dependencies.\n\n```yml\nfeature-tests:\n  docker:\n    - image: name-of-your-image.xxx.xxx.eu-west-1.amazonaws.com/feature-tests:latest\n  working_directory: /app\n  steps:\n    - run:\n        name: run tests\n        command: |\n          bundle exec cucumber features/app_under_test\n    # collect reports\n    - store_test_results:\n        path: /tmp\n    - store_artifacts:\n        path: /reports\n```\n\nOnce the job was defined I was ready to include it in the project workflow. I wanted my tests to run once the application under test was deployed to staging. To do so I used the `requires` field and set it up to `deploy` and also specified in filters \u003e branches that I only want to run the tests when the application is deployed in staging.\n\n```yml\n# /.circleci/config.yml\nversion: 2\nworkflows:\n  version: 2\n  build_test_deploy:\n    jobs:\n      - deploy:\n          context: aws\n          filters:\n            branches:\n              only:\n                - staging\n                - production\n      - feature-tests:\n          requires:\n            - deploy\n          context: featuretests\n          filters:\n            branches:\n              only:\n                - staging\n```\n\nWhen you work on the config file be very careful with the indentation. Before trying your config live you can run validation if you have CircleCI's cli installed, i.e. `circleci config validate`. Using the cli you can also run the build locally. For more information go to [local-cli](https://circleci.com/docs/2.0/local-cli/).\n\nComplete file `config.yml`:\n\n```yml\nversion: 2\nworkflows:\n  version: 2\n  build_test_deploy:\n    jobs:\n      - deploy:\n          context: aws\n          filters:\n            branches:\n              only:\n                - staging\n                - production\n      - feature-tests:\n          requires:\n            - deploy\n          context: featuretests\n          filters:\n            branches:\n              only:\n                - staging\njobs:\n  deploy:\n    docker:\n      - image: application-image.xxx.xxx.eu-west-1.amazonaws.com/node:latest\n    working_directory: ~/code\n    steps:\n      - checkout\n      - restore_cache: # special step to restore the dependency cache\n          key: dependency-cache-{{ checksum \"yarn.lock\" }}\n      - run:\n          name: yarn\n          command: yarn --no-progress\n      - save_cache: # special step to save the dependency cache\n          key: dependency-cache-{{ checksum \"yarn.lock\" }}\n          paths:\n            - ./node_modules\n      - run:\n          name: node-sass\n          command: npm rebuild node-sass\n      - run:\n          name: yarn test\n          command: yarn test\n      - run:\n          name: yarn build\n          command: NODE_ENV=$CIRCLE_BRANCH yarn build\n      - run:\n          name: deploy\n          command: ./deploy.sh\n  feature-tests:\n    docker:\n      - image: feat-tests-image.xxx.xxx.eu-west-1.amazonaws.com/feature-tests:latest\n    working_directory: /app\n    steps:\n      - run:\n          name: run tests\n          command: |\n            bundle exec cucumber features/application_under_test\n      # collect reports\n      - store_test_results:\n          path: /tmp\n      - store_artifacts:\n          path: /reports\n```\n"}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"set-up-automation-tests-in-circleci"},"buildId":"mE7KzKri9wqOQRXPl0qj8","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>